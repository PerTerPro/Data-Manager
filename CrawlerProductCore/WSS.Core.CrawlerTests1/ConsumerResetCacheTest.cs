using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using WSS.Core.Crawler;
using NUnit.Framework;
using QT.Entities;
using QT.Moduls;
using Websosanh.Core.Drivers.RabbitMQ;

namespace WSS.Core.Crawler.Tests
{
    [TestFixture()]
    public class ConsumerResetCacheTest
    {
        [Test()]
        public void ConsumerResetCacheServiceTest()
        {
            ConsumerResetCacheProduct consumerResetCacheService = new ConsumerResetCacheProduct(RabbitMQManager.GetRabbitMQServer(ConfigRun.KeyRabbitMqCrawler), ConfigCrawler.QueueResetCacheProduct);
            consumerResetCacheService.StartConsume();
        }

        [Test()]
        public void ConsumerPushCompanyReloadTest()
        {
            string arCOmpanyId = GetStrCompany;
            ProducerBasic producerBasic = new ProducerBasic(RabbitMQManager.GetRabbitMQServer(ConfigRun.KeyRabbitMqCrawler), ConfigCrawler.QueueCompanyReload);
            foreach (var VARIABLE in arCOmpanyId.Split(Common.arSplitToList,StringSplitOptions.RemoveEmptyEntries))
            {
                producerBasic.PublishString(new JobCompanyCrawler() {CheckRunning = false, CompanyId = Convert.ToInt64(VARIABLE)}.GetJSon());
            }
        }

        [Test()]
        public void ConsumerPushCompanyFindNewTest()
        {
            string arCOmpanyId = GetStrCompany;
            ProducerBasic producerBasic = new ProducerBasic(RabbitMQManager.GetRabbitMQServer(ConfigRun.KeyRabbitMqCrawler), ConfigCrawler.QueueCompanyFindnew);
            foreach (var VARIABLE in arCOmpanyId.Split(Common.arSplitToList, StringSplitOptions.RemoveEmptyEntries))
            {
                producerBasic.PublishString(new JobCompanyCrawler() { CheckRunning = false, CompanyId = Convert.ToInt64(VARIABLE) }.GetJSon());
            }
        }

        [Test()]
        public void PushResetCompany()
        {
            string arCOmpanyId = GetStrCompany;
            ProducerBasic producerBasic = new ProducerBasic(RabbitMQManager.GetRabbitMQServer(ConfigRun.KeyRabbitMqCrawler), ConfigCrawler.QueueResetCacheProduct);
            foreach (var VARIABLE in arCOmpanyId.Split(Common.arSplitToList,StringSplitOptions.RemoveEmptyEntries))
            {
                producerBasic.PublishString(new JobCompanyCrawler() { CheckRunning = false, CompanyId = Convert.ToInt64(VARIABLE) }.GetJSon());
            }

        }

        public string GetStrCompany = @"3814887581791149406
3011499751433770287
2410517391153371388
5974211336610791697
5152493784036316998
6785040059346326293
7155031287135052552
8005244389234378400
4964049477362025665
2383355729294355166
5764526639584307420
6767560216541685305
1425600238401658071
383547177440796499
2860890334019952903
4498206517221140817
338737167975865467
6357630333325875398
2497124664663166206
4269563365187641663
1326413467793431706
8601666684672050445
4987068531377424895
4811496168179482404
1986717311087858453
709522695648043587
4839779799356465089
4670513351829956913
3596543745780431360
4057466499833005293
210446124438568469
4096138716988617109
8245077398266867262
7896357388680045824
1068866286226961474
1540400078599352031
8115000864538359394
2777253063272335427
9015919487988958051
5780186572251813084
7263862637341143708
7472755444799077746
8697506683162239385
34827326371902632
4081461361464263537
6568663644116288705
443981465060026315
5711305618976337664
3709203800355740323
8778381359645484445
7639110102870520652
6592756829478057752
3056148800652374396
1117787576477742813
264732402976534824
7449946584796515470
2825484895263281392
5452872697646669520
6844091453269262186
3148280544391225377
995619413223219437
2583023640693713919
5934967485317390177
1214337042320317482
7713030879258036797
7231256174664308855
2881866773075814478
6456534349511211366
3931428091122543812
5574844280642846328
1217361267045202969
6402580776812505902
4693931692223115015
6575778691704661975
3554641521359800087
3621120437407166794
4540313420368521572
7149173140357605211
277079857784200740
1587780652596310652
574866704653246543
7149413827575021356
6353859007567599557
5291587740848544720
1945305628251145083
6213062686076391354
3732403278899908083
189077706850972101
4593387779308072486
8756187014848305838
6040474993926783671
8041701604532573315
3295331979042956262
5537678631238037969
2665149903697641065
1461479011852567234
497568489285241070
7109389231130715174
5628606189145692448
1420632092437008539
4401389890458602373
8117952472331737291
4518262076846400680
7369774180978761136
3222379782499155361
8566998578890434405
6868911312903523964
4072611420141212225
3568754210148030580
3029928744910109737
7316183372743828125
594463987879156455
5259234054694955623
7702241131679240235
1388499401058277511
7107720495502665164
105722530031050377
6574578878158087032
6771789959186467695
3402513101276048385
807961616636117214
3663846242359707025
3182775078562785136
6459946822931645065
4436652632369401007
2149969933906219346
2825697851403891009
2348747842967348682
2410822328113888056
4019315694772472699
979404572154802790
2181995328595516929
2640246683724213978
9015933511487473020
2818308467297336486
5121591607984361628
7261748819023040524
1749651310658872652
1536648817279505289
6872502860162821531
4532252416450580781
2384616099705072739
4444922448878904148
4268545103207276394
2825964338550547502
1972318960466502630
1194290568885871070
2826786716944557018
1410988591232418898
6781459297262251102
7283124727297758500
2455075740907404301
3040000426015967904
6733649001220023429
4093447896890423841
696573020308449063
7441323718077395551
3700371642354896036
6235148900844863765
9025723014134322450
4906394970980195841
4750153637014639266
6892193774020167548
6886157611891729655
5868932082705658113
6441653340650379460
7451305026356369076
7057857481765233723
1088281219764903647
1080562783303361140
7737415598783905929
6134342539363705430
7819965365166819968
200597249094292605
4755469880989731777
3688846362550551121
740862569152621503
6148502986504223440
9172385208992126480
396512436933674729
2815164365713629649
3271849692552928716
1821436880379173221
2186418740679244296
1732809408685787615
1275399201179021487
1891287602940003426
7165822317026075095
1409492063788387298
7669295836676609772
5729419046935135731
6094100991841036377
7435181927690951960
7724710511064835899
3432699389574548802
2549879707524590849
6226527328596106187
7367796453305284150
1308326778452326266
1726886375245113764
5224344608389993767
4155963288603388918
3587375819717330897
952390462801111866
4708341783904799837
1743377774613076220
8941951062700065878
7698983405824008804
678540263639835127
5001156913293191190
3538049793907101904
2093494095746751472
6754909035580788268
713585698261673920
3337512493026726191
8062092649457941459
4303206476524116883
3450889366704264564
582607571233762454
5055426047559961525
1678814730608671947
8565033045355484673
3222443447814895829
1530328662573939891
4444461242116916365
1150256684203887869
2163325442657625642
2296230979465751189
880896059734813667
7794554436064925999
7144074993598965322
1304625927658745709
4862165583329130736
4713587300536000145
8788318896535272437
3482112000405438524
2830631287463263221
6750352346919130080
2643292533570333336
5259901463705082682
7120162130569781418
5398216945379203484
1537425713200733479
6736909653071396258
3236827392233796669
420688193243232184
2059135687128289779
7365050608300381335
5021517462761282092
1316911431744009097
2184975414761283117
5483399277376294234
6561366046418497952
2157308128698622434
5891897461916670070
4627274248543208556
5427745202944501894
2869169232921099319
5271378977802581146
7308682217654223832
222723561860402695
6611045682959815229
245149646153156094
6458793472957152221
1699806860211048153
8794905388257867983
4733373203401127506
2713541499875874876
5281994734504849998
2016896836480832006
1744500395968024131
7479673201229875249
84283602989216394
7186522091004680518
8207468293084248739
1320855472596500678
4756266243346210827
331618886034916118
3856409778846987571
3767766900644342829
9005929283420379690
1087546825502764088
8196692268198665824
1300468532607736901
437425210258348648
5141444571088536501
1250669958801187441
7700170243899807398
9149453878129847506
1769961186123723076
3639970306578673533
7045987687838442831
5334404876680224809
1851887531962384287
7429483025363865826
2419349560048171344
1939068527696678870
5890157781486446030
3859173519981703993
829907394449812071
2660013428508838710
8592593562781707422
4451218882055269208
5973195585060504966
7211010207783457563
6809047793547679249
9214027724996434212
6923094991318499121
1084843141673419916
1793534743671200240
4934781771223965862
5949539631173410876
8832203656027508250
6977596330393165128
2386640274542830688
3369376531259885047
5366484635697488490
5637714798410625588
977102872451298144
3726659040840609658
6113390443055150878
2137565089789938760
8298992786475688304
5427305866666939882
3082229048112796971
5465561729800818321
5143866939226727230
7366986994879504757
4318936800384178045
4210541589441364872
3035098762288462506
8344269661920209638
7269517151517864698
7900458414751139936
7965456894577917663
4980731195052219995
8826745624682840495
8917531634059384885
3043742598871795378
1589710011876109267
4177778369888952853
2157787152139403968
688597778012369731
5137939026991330367
4940558433775030124
5303653132004150013
760810985831014298
5730467908399429827
4845630366642346562
5793170764020693231
4229446996057635311
1941103859329677145
5832933675190866580
2750047581361515714
7814472182497602442
4531345512277765368
8887779989834364480
3286134780934535062
9210343903049753000
8865122248053809237
3771583813271916338
6176965631997691703
854043598328848051
4533934727383530162
2154018756711283858
6233546499220400988
5884472413561514346
8920765389856956375
1935734272088067273
6260340119781244815
3553618419942218892
6297058872768370569
246069345300031362
2233794195264659181
6198095467185002355
7676571012079310520
5257200506714258639
3374084457871738996
5847076826093936442
1707406764605898714
6860650899738168177
5364872534192251851
2478834905786986101
689536510722408940
2792321730148961496
1553228793369605032
8099688708089734914
7725846185394231213
9168843599672629040
5795792172631825060
6494156103866300768
7065201440754756049
7043661402430615498
6934004715831750790
8594555269418691846
7237818386387783442
6954864503224412516
8850593546570037521
2842617018905249361
2671555179726366462
4188299464659390012
7510536886365000833
465444604659274025
5800841782934171133
8490897710747744479
3904608134445422082
3574930961625289329
1134186980124440817
6000584076349562659
1146117151627563656
5053335693627082636
4971770849131704019
7097826167650816348
299823550693974465
1921586619347360119
244096659624633969
2274229814591471475
4929585217043016686
7177823106955514689
4349110215660456953
2532926370774568011
3758166450662329379
7863790181826081199
428510740969241558
8055856380563970875
4460100653796651562
3309611577843405659
3971799191246013009
7535468315723336135
4412523371592222422
4440171536624283716
6706843136631808624
3446805255588202614
1436782880663347030
4961098521533171023
6672168894333516022
1514238690734104715
8807775602443937985
3265365336339825189
8033867808816588142
8840631449620950359
3967278410472161428
8328290534339713436
5706113368225577557
6355493256846682954
6852109698511461614
8971438704068683825
6018419649543333872
3210640681732478739
758436799736660106
6109221406002787390
3374977875853412140
5393060843849108473
1122814492606982046
876622114602570397
4075963089725497504
7694293758326959623
656749824287169829
301403393741188646
4298520728665939631
7618179105147334311
4938990649030098202
6013441523780643861
3627734223462092935
8210667315119849629
7508364514754788164
564697730698645462
8358015968393114849
9011420588843174238
4800629781776437782
4964361811450214048
6653148909423261327
1562540367257923662
3783152869806518675
1034720944999140170
1475318347430833871
1947581445086893822
3083994983044262607
1359381263707218230
5865429703006517630
8389110671048747826
7068596554170084239
3022469490159516970
2192254803736183998
9001206240211481848
7106119916426435183
836158407936854559
1916509453779296046
2369209297018871633
4238873675599290566
3517964693408151629
1692392803532750188
2452329613680998369
4205238074264090301
3796635060194259642
4720470512496474774
8057902856864670319
627888232830169873
2052206759383241587
4984633074807122569
1092239723607073277
3544536904543820133
8883190928698624147
1894599028667092889
5013704321581484166
1431055967036253860
561628988560421866
4311727692047845536
3796320247548117767
8466872924515350832
8306545930617485245
5247269218436676018
5686651411324700059
5873244511420160982
3637376284697134219
2356201104716095711
7198826311303350097
352319406939805874
4936876012018069119
3375326569944196842
3952613077936852779
2122580787470891078
542439908948157153
257730325095005236
7988532696198957590
4927729492993822115
1899360412529691530
5434806827871360372
7995183765738143359
7940389183237977001
6554985613933406689
824350519520886404
2171484759405171670
4259997483134069184
599797124713861759
3133598707305975936
4931090504913943693
2832743462938209185
72565543860191938
311732423658417506
2549044932554712820
4074795224223298830
7149429561471550842
4999685006212989729
1724727243346097732
3129174922854812757
5031928018857057382
8108881707855681302
8397198532149388973
6065906297512894364
3720902689314973642
2611815848034305866
6387460907222631025
5452617700761330558
3544984643797406393
98062854258722571
5608217859340019698
5271417306130939077
9144208989234913638
7642536576860731956
2056205097224446589
8655859985930825104
6797013795122921659
7131722145261123245
2114990840069241826
4346710948134054402
7616470790983456775
4275605588983425702
385123995841999071
3847959878044906355
3514277217586216081
6891751640453639693
6948298102830783856
6794981053680547383
2799077462900609361
1263008624739795162
3382748280299511565
370462522042333381
3594976695017042436
698471510816501822
3819591951356437309
3830059984297695433
4035521741166645636
3625026602069360540
6375429301217876218
1190387878495695421
1705635813423460784
4688933527739003800
2442342780421363041
2396652272721915105
1052217492088786154
7726006015267756
3407601656144301521
2651399639396822989
8036253643937056547
3755524373202172877
8468842732791749788
1331114786511289132
1087305911932093444
4799421028044269032
6593261768336620264
8372891563476676044
668973189274455037
3934740482481630466
5904770254846315425
4704208923488426000
6345622392420402113
1085981498271299042
2499386864674616041
7245109428483165466
3801461762491542729
584068704878271051
767928799543623978
3571967713668857314
780445819085306102
3912613850228296092
6071174725131482209
2581104505643862860
1202070936051858206
6921682503570044794
3610220984368514296
3834635148374500752
7274378468521513864
8420985943598406892
4982358954591732917
1525877883003554832
6191972469283070783
9156944987931904653
9146802325115625962
8515900130442449304
6248464288235095848
2720859184461425544
8880349535151836984
8223820966383374348
4155628836250900870
8203168026442390759
8978222066185479945
8826927984316830852
5551388634681885629
2441516531808871853
3936649914454851015
9040300731491487202
7721280682207779987
2893525246020303009
4497430323513481912
6396297228877232489
3535412108502165676
8923813711556934424
735988149413889826
1093971674887712728
5806100146436801373
8150905427141033920
3488628083931778002
230649670194171494
2755791206456615851
8593800958200188125
4005919839031860564
4732778716925302400
2670364325508344657
2356330391508990076
2036479915779248957
1430091469580059574
5421756515481877919
3272817117525814688
5809209566105413812
6418089182600170108
8235663896024083352
7083864728197047093
206149104104570109
7133716064416692863
6958619330237936095
3984282398054346856
7601463334720423105
1887063135325930915
1551919553494654814
1016765090888353767
3064372290179305023
5626870391589630451
629954809814667747
7659106687101377329
7744432300384669088
2444477797441792084
52983219556963070
1769623801417423597
4796163719559285419
5266928929003155094
3172433057900587454
4115849749301303580
3719378100469255654
7093495848536139351
9210730647707620368
5496657075104010439
1423451245950407352
1702412825482622036
5797680640748094057
6101542701250480691
1963763568377885691
6569900764383334330
1144075357460726459
7179480431873513814
393261246330034227
8384564127076264248
7171652046030682317
8479974535983605665
1474470330212164169
5858737092629699249
2794273066119018226
770543737331821267
6684849678913527109
1354430598864534977
13871136602979996
6068586014134715018
6835834506702424115
8432944935119187483
1097597256236304581
750825755608493929
4272870633165258180
5639224205379827194
6036905626720866439
9074293326921647536
1182083144011683385
2255542281124454850
8300529892461668020
8545146245207322922
7655827662433659530
7155650056555526823
9080354532777356554
4314020884517793008
8694784794459441916
394798673660655381
6840988354869965329
8467751249390709136
1015791933728808957
4335837238064696063
358897809372521163
1922372998459854138
3541216471310685424
32600554641381519
5711213335539796704
3911164877550721999
5958477606849234377
1340045272233474437
7918048524730032485
4837302297698435324
7204221810752634636
3840794143412422500
7023488050907834599
8867818737583809731
8114671793682929795
2838333570437820587
4421613320820607167
6335084976659478184
6146599820343038143
5476721923131307685
2068879464658650968
5780925326279354976
369288087325231194
2993493055542250836
3473673230877795174
9101662741668407187
1535657774171931585
8497684326485612826
1964898340120673702
9063328542147438142
4288550758316336439
9137229552988153040
5715704225316891938
4818818375679912638
6571515658090941950
2226400229337804332
6931267963512525955
3800942430392939601
1341192215116582669
7926968849274726132
7782036929400406072
7803174868362152920
2238525769475460994
2657607708810418826
8201203732671905493
7107110125652908898
2282065399013215683
6417952630483047566
2733922819774224011
5433577840074586530
3840659630226923436
2221275054239410061
5812503422474509236
956212517194872601
1770284034914576202
883160315036824352
882328504983139685
4013199794438722784
4624982867363673386
2787832304493899046
5758604378788876570
1272446542014458172
7944152423612280414
4714763416152611456
4172394508557946388
6905653106969560303
166217627800746477
7068049034704324544
108159521515736509
7365017820865175128
7872005318616726371
3980839765016177852
7585076734783523767
7653340550024738397
2247153949712182231
1769813906117373576
136745065203401684
7593477647506111404
6767954109306278768
4575050867031389376
8553876667909078826
1610988865535340599
2506464636731821769
7451460229021592222
2184411190937621130
2586447564418101721
7395990284978679019
4884952289762044955
8002359352653867890
3358661489375739214
1115453141491584877
5711692316099235604
2505288109667094374
8360037903793074641
2916512887872576355
1137163748382879
6952380901759688875
8517370985949332745
616661471098582939
3494101943763199742
2361486445513355009
7592220271933172593
7185103023405531080
5596870926442085184
6185060302884803173
5767207128413695200
8399890313770716539
7637635149939250269
1666003086819875078
2578861201074438898
6293552185972759320
3906684686466236919
1865763800998745562
3467598158331488248
2849740586370562859
6193113206741363413
6123843801102594619
2394327690438790332
3717738075695104340
4560377516439424114
7385803240072933787
3657655609283210895
3579959252677248413
6219607648809808029
167340977344014974
1836934060034995898
6016135117739755793
4205963956072466371
5979920077563306787
3609055218554697826
1106561565991215217
4147183552129915566
3766871930699081033
864734988067231003
1317898015396818187
471984085724950352
1238770379373896778
9031906280577194464
4820476521068916468
5511661976672892794
7283224557123850832
8804331197335599045
7971583185742779911
2236894228402907292
6126508651734662747";

        [Test()]
        public void ProcessMessageTest()
        {
           
        }

        [Test()]
        public void InitTest()
        {
            
        }
    }
}
